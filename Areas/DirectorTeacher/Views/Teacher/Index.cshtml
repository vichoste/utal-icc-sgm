@using Utal.Icc.Sgm
@using Utal.Icc.Sgm.Areas.DirectorTeacher.Views.Teacher

@model PaginatedList<IndexViewModel>

@{
	this.ViewData["Title"] = "Profesores";
}

<div class="container">
	@if (this.TempData["SuccessMessage"] is not null) {
		<div class="row justify-content-center">
			<div class="alert alert-success" role="alert">
				@this.TempData["SuccessMessage"]
			</div>
		</div>
	}
	@if (this.TempData["SuccessMessages"] is not null) {
		@foreach (var success in (IEnumerable<string>)this.TempData["SuccessMessages"]!) {
			<div class="row justify-content-center">
				<div class="alert alert-success" role="alert">
					@success
				</div>
			</div>
		}
	}
	@if (this.TempData["SuccessMessages1"] is not null) {
		@foreach (var success in (IEnumerable<string>)this.TempData["SuccessMessages1"]!) {
			<div class="row justify-content-center">
				<div class="alert alert-success" role="alert">
					@success
				</div>
			</div>
		}
	}
	@if (this.TempData["SuccessMessages2"] is not null) {
		@foreach (var success in (IEnumerable<string>)this.TempData["SuccessMessages2"]!) {
			<div class="row justify-content-center">
				<div class="alert alert-success" role="alert">
					@success
				</div>
			</div>
		}
	}
	@if (this.TempData["WarningMessage"] is not null) {
		<div class="row justify-content-center">
			<div class="alert alert-warning" role="alert">
				@this.TempData["WarningMessage"]
			</div>
		</div>
	}
	@if (this.TempData["WarningMessages"] is not null) {
		@foreach (var warning in (IEnumerable<string>)this.TempData["WarningMessages"]!) {
			<div class="row justify-content-center">
				<div class="alert alert-warning" role="alert">
					@warning
				</div>
			</div>
		}
	}
	@if (this.TempData["WarningMessages1"] is not null) {
		@foreach (var warning in (IEnumerable<string>)this.TempData["WarningMessages1"]!) {
			<div class="row justify-content-center">
				<div class="alert alert-warning" role="alert">
					@warning
				</div>
			</div>
		}
	}
	@if (this.TempData["WarningMessages2"] is not null) {
		@foreach (var warning in (IEnumerable<string>)this.TempData["WarningMessages2"]!) {
			<div class="row justify-content-center">
				<div class="alert alert-warning" role="alert">
					@warning
				</div>
			</div>
		}
	}
	@if (this.TempData["ErrorMessage"] is not null) {
		<div class="row justify-content-center">
			<div class="alert alert-danger" role="alert">
				@this.TempData["ErrorMessage"]
			</div>
		</div>
	}
	@if (this.TempData["ErrorMessages"] is not null) {
		@foreach (var error in (IEnumerable<string>)this.TempData["ErrorMessages"]!) {
			<div class="row justify-content-center">
				<div class="alert alert-danger" role="alert">
					@error
				</div>
			</div>
		}
	}
	@if (this.TempData["ErrorMessages1"] is not null) {
		@foreach (var error in (IEnumerable<string>)this.TempData["ErrorMessages1"]!) {
			<div class="row justify-content-center">
				<div class="alert alert-danger" role="alert">
					@error
				</div>
			</div>
		}
	}
	@if (this.TempData["ErrorMessages2"] is not null) {
		@foreach (var error in (IEnumerable<string>)this.TempData["ErrorMessages2"]!) {
			<div class="row justify-content-center">
				<div class="alert alert-danger" role="alert">
					@error
				</div>
			</div>
		}
	}
	<div class="row justify-content-center">
		<div class="col-12 col-md-10 mb-3">
			<h2>@this.ViewData["Title"]</h2>
		</div>
		<div class="col-12 col-md-2 mb-3">
			@this.Html.ActionLink("Crear profesor", "Create", "Teacher", new { area = "DirectorTeacher" }, new { @class = "btn btn-success"})
		</div>
		<div class="col-12 mb-3">
			<partial name="_Filter" , model="@new FilterPartialViewModel()" />
		</div>
	</div>
	<div class="row justify-content-center">
		<div class="col-12">
			<div class="table-responsive">
				@this.Html.HiddenFor(m => m.ApplicationUserId)
				<table class="table table-bordered">
					<thead class="table-dark">
						<tr>
							<th>
								<a asp-action="Index" asp-route-sortOrder="@this.ViewData["FirstNameSortParam"]" asp-route-currentFilter="@this.ViewData["CurrentFilter"]">
									Nombre
								</a>
							</th>
							<th>
								<a asp-action="Index" asp-route-sortOrder="@this.ViewData["LastNameSortParam"]" asp-route-currentFilter="@this.ViewData["CurrentFilter"]">
									Apellido
								</a>
							</th>
							<th>
								<a asp-action="Index" asp-route-sortOrder="@this.ViewData["RutSortParam"]" asp-route-currentFilter="@this.ViewData["CurrentFilter"]">
									RUT
								</a>
							</th>
							<th>
								<a asp-action="Index" asp-route-sortOrder="@this.ViewData["EmailSortParam"]" asp-route-currentFilter="@this.ViewData["CurrentFilter"]">
									E-mail
								</a>
							</th>
							<th>Acciones</th>
						</tr>
					</thead>
					<tbody>
						@foreach (var item in this.Model) {
							<tr>
								@if (item.IsDeactivated) {
									<td class="text-muted">@item.FirstName</td>
									<td class="text-muted">@item.LastName</td>
									<td class="text-muted">@item.Rut</td>
									<td class="text-muted">@item.Email</td>
									<td>
										@this.Html.ActionLink("Activar", "ToggleActivation", "Teacher", new { area = "DirectorTeacher", id = item.Id }, new { @class = "btn btn-success mb-3"})
									</td>
								} else {
									<td>@item.FirstName</td>
									<td>@item.LastName</td>
									<td>@item.Rut</td>
									<td>@item.Email</td>
									<td>
										@this.Html.ActionLink("Editar", "Edit", "Teacher", new { area = "DirectorTeacher", id = item.Id }, new { @class = "btn btn-yellow mb-3"})
										@this.Html.ActionLink("Desactivar", "ToggleActivation", "Teacher", new { area = "DirectorTeacher", id = item.Id }, new { @class = "btn btn-danger mb-3"})
										@if (item.IsDirectorTeacher) {
											<a asp-action="Index" asp-route-sortOrder="@this.ViewData["CurrentSort"]" asp-route-pageNumber="@(this.Model.PageIndex)" asp-route-currentFilter="@this.ViewData["CurrentFilter"]" class="btn btn-info mb-3">Es director de carrera</a>
										} else {
											@this.Html.ActionLink("No es director de carrera", "Transfer", "Teacher", new { area = "DirectorTeacher", currentDirectorTeacherId = this.Model.ApplicationUserId , newDirectorTeacherId = item.Id }, new { @class = "btn btn-default mb-3" })
										}
									</td>
								}
							</tr>
						}
					</tbody>
				</table>
				@{
					var prevDisabled = !this.Model.HasPreviousPage ? "disabled" : "";
					var nextDisabled = !this.Model.HasNextPage ? "disabled" : "";
				}
				<ul class="pagination mb-0">
					<li class="page-item @prevDisabled">
						<a asp-action="Index" asp-route-sortOrder="@this.ViewData["CurrentSort"]" asp-route-pageNumber="@(this.Model.PageIndex - 1)" asp-route-currentFilter="@this.ViewData["CurrentFilter"]" class="page-link">
							Anterior página
						</a>
					</li>
					@for (var i = 0; i < this.Model.TotalPages; i++) {
						<li class="page-item @(i + 1 == this.Model.PageIndex ? " active" : "")">
							<a asp-action="Index" asp-route-sortOrder="@this.ViewData["CurrentSort"]" asp-route-pageNumber="@(i + 1)" asp-route-currentFilter="@this.ViewData["CurrentFilter"]" class="page-link">
								@(i + 1)
							</a>
						</li>
					}
					<li class="page-item @nextDisabled">
						<a asp-action="Index" asp-route-sortOrder="@this.ViewData["CurrentSort"]" asp-route-pageNumber="@(this.Model.PageIndex + 1)" asp-route-currentFilter="@this.ViewData["CurrentFilter"]" class="page-link">
							Siguiente página
						</a>
					</li>
				</ul>
			</div>
		</div>
	</div>
</div>